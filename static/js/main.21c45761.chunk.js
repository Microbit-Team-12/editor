(this.webpackJsonpeditor=this.webpackJsonpeditor||[]).push([[0],{230:function(t,e){},232:function(t,e){},243:function(t,e,n){},245:function(t){t.exports=JSON.parse('{"Intro":{"speech":"Quack! Tell me more about the problem by selecting a button below:","buttons":[{"text":"An error message is displayed","link":"Select error message"},{"text":"My code doesn\'t do what I want it to do","link":"Select the problem with your program"}]},"Select error message":{"speech":"{get_error_line_no_and_highlight}","buttons":[{"text":"AttributeError","link":"AttributeError explanation"},{"text":"SyntaxError","link":"SyntaxError explanation"},{"text":"TypeError","link":"TypeError explanation"},{"text":"NameError","link":"NameError explanation"},{"text":"IndentationError / TabError","link":"IndentationError explanation"},{"text":"Something else / I don\'t know","link":"Less common errors"}]},"AttributeError explanation":{"speech":"An AttributeError tells you that a certain type (such as int or str) doesn\u2019t have a certain attribute. For instance, if you write display.potato, Python will give an AttributeError to tell you that display has no potato attribute.","buttons":[{"text":"Tell me more","link":"More about AttributeError"}]},"More about AttributeError":{"speech":"To get an AttributeError, you might have accidentally used the wrong datatype or misspelt the function you called? Or perhaps you used a capital letter by mistake \u2013 Python treats show and Show as two different things.","buttons":[{"text":"Ah, that\'s it!","link":"Goodbye"},{"text":"I still need help","link":"{inTutorial ? Ask if want to compare : Duck gives up}"},{"text":"back","link":"AttributeError explanation"}]},"Goodbye":{"speech":"I\u2019m happy that I could help you! Now you\u2019ve learnt something new, so you\u2019ll know what to do next time you get that problem.\\n\\nRemember you can click on my icon any time if you need more help!","buttons":[{"text":"Thanks Duck, bye for now!","link":null}]},"Ask if want to compare":{"speech":"I see you\'re doing one of our tutorials. Do you want to compare the error in your code to our example solution?","buttons":[{"text":"Yes","link":"Compare with tutorial"},{"text":"No","link":"Duck gives up"}]},"Compare with tutorial":{"speech":"{get_readable_diff}","buttons":[{"text":"Thanks, I can fix that now.","link":"Goodbye"},{"text":"That wasn\'t what I was trying to write","link":"Duck gives up"}]},"Duck gives up":{"speech":"This seems strange... Perhaps you would have better luck reading the tutorial about errors? You can access it by pressing \\"Select tutorial\\" at the top, and then selecting \\"Python Errors\\". ","buttons":[]},"SyntaxError explanation":{"speech":"A SyntaxError might happen if you used the wrong punctuation (eg: using \u2018;\u2019 instead of \u2018:\u2019) or if you misspelt a keyword (such as for, while, if, or else).","buttons":[{"text":"Ah, that\'s it!","link":"Goodbye"},{"text":"No, I still need help","link":"More about SyntaxError"}]},"More about SyntaxError":{"speech":"Sometimes a helpful message appears with a SyntaxError, such as \u201ccan\u2019t assign to literal\u201d. Which message do you see?","buttons":[{"text":"Invalid Syntax (no further message)","link":"Invalid Syntax nfm explanation"},{"text":"Invalid Syntax for (number/integer with base 10)","link":"Invalid Syntax number explanation"},{"text":"Can\'t assign to [something]","link":"Invalid Syntax can\'t assign explanation"},{"text":"Something else","link":"Invalid Syntax something else"}]},"Invalid Syntax something else":{"speech":"Does this match your error message: \\"SyntaxError: cannot mix bytes and nonbytes literals\\"?","buttons":[{"text":"Yes","link":"Cannot mix bytes"},{"text":"No","link":"{inTutorial ? Ask if want to compare : Duck gives up}"}]},"Cannot mix bytes":{"speech":"Python gives you this error if you forget the brackets in a function call. For instance, if you write \\"print hello\\" instead of \\"print(hello)\\" Python will give you this error message.","buttons":[{"text":"Ah, that\'s it!","link":"Goodbye"},{"text":"I still need help","link":"{inTutorial ? Ask if want to compare : Duck gives up}"}]},"Invalid Syntax nfm explanation":{"speech":"You might get this error if you write an \u201cempty\u201d for loop or while loop (one with nothing in it because you didn\u2019t indent), or if you forgot to close the square brackets at the end of a list.","buttons":[{"text":"Ah, that\'s it!","link":"Goodbye"},{"text":"No, I still need help","link":"{inTutorial ? Ask if want to compare : Duck gives up}"}]},"Highlight error":{"speech":" Do you spot the mistake now?","buttons":[{"text":"Thanks, thank you!","link":"Goodbye"},{"text":"No, I still need help","link":"{inTutorial ? Ask if want to compare : Duck gives up}"}]},"Invalid Syntax number explanation":{"speech":"Python gives this message when you attach something confusing to the end of a number. Eg: Python knows about 3, but it doesn\u2019t know about 3f or 3.f. If you are trying to multiply a number by a variable, use the * symbol. Or maybe you just made a typo.","buttons":[{"text":"Ah, that\'s it!","link":"Goodbye"},{"text":"I still need help","link":"{inTutorial ? Ask if want to compare : Duck gives up}"}]},"Invalid Syntax can\'t assign explanation":{"speech":"Python complains that it \u201ccan\u2019t assign to expression\u201d if you use the single equals sign ( = ) in a place where it doesn\u2019t belong. For example, \u201c3 = x\u201d would be read as \u201cchange the value of 3 to make it x. But that\u2019s nonsense because you can\u2019t change 3!","buttons":[{"text":"Tell me more...","link":"More about assignment error"}]},"More about assignment error":{"speech":"If you\u2019re trying to change the value of a variable, the variable name (eg: x) needs to go on the left, and the value (eg: \u201chello\u201d, or 10) needs to go on the right of the = sign.\\nIf you\u2019re trying to test if 2 values are equal, use == rather than = .","buttons":[{"text":"Ah, that\'s it!","link":"Goodbye"},{"text":"I still need help","link":"{inTutorial ? Ask if want to compare : Duck gives up}"},{"text":"back","link":"Invalid Syntax can\'t assign explanation"}]},"TypeError explanation":{"speech":"Python throws a TypeError if you use a value in a way that doesn\u2019t make sense for its type. For instance, \u201c3\u201d + 5 would throw a TypeError because you cannot add a str to an int.","buttons":[{"text":"Ah, that\'s it!","link":"Goodbye"},{"text":"I still need help","link":"{inTutorial ? Ask if want to compare : Duck gives up}"}]},"NameError explanation":{"speech":"A NameError tells you that Python doesn\u2019t understand a certain word that you used. Reread the error message to see which word this is. It might just be that you\u2019ve mistyped it! Remember that Python is case-sensitive (so you mustn\u2019t use a capital letter where it expects a lower-case one).","buttons":[{"text":"Ah, that\'s it!","link":"Goodbye"},{"text":"I still need help","link":"{inTutorial ? Ask if want to compare : Duck gives up}"}]},"IndentationError explanation":{"speech":"The indentation is a fancy way of saying the amount of space at the beginning of the line. Within a given loop, all lines must have the same indentation. You should always use tabs rather than spaces for this.","buttons":[{"text":"Ah, that\'s it!","link":"Goodbye"}]},"Select the problem with your program":{"speech":"Select the problem:","buttons":[{"text":"My program does nothing at all","link":"Program does nothing"},{"text":"A condition isn\'t working (eg: in if statement or while loop)","link":"Condition isn\'t working"},{"text":"Certain parts of my program are skipped","link":"Certain parts skipped"},{"text":"A list has changed even though I didn\'t change it","link":"List has changed"},{"text":"Something else","link":"Duck gives up"}]},"Program does nothing":{"speech":"If your program does nothing at all but doesn\u2019t show an error, it might be because you defined a function and forgot to call the function. To call a function, you need round brackets ().","buttons":[{"text":"Ah, that\'s it!","link":"Goodbye"},{"text":"No, that\'s not what I\'ve dome","link":"More about program does nothing"}]},"More about program does nothing":{"speech":"Another reason why your program might do nothing is if you forgot to output anything! Assigning to variables doesn\u2019t show anything on the Micro:Bit display unless you also call display.show. Do not call print because it doesn\u2019t work on the Micro:Bit.","buttons":[{"text":"Ah, that\'s it!","link":"Goodbye"},{"text":"I still need help","link":"Duck gives up"}]},"Condition isn\'t working":{"speech":"You\u2019ve told me that a condition isn\u2019t working. Is your condition simple (just uses one comparison) or complex (uses and / or ) ?","buttons":[{"text":"Simple","link":"Simple condition"},{"text":"Complex","link":"Complex condition"}]},"Simple condition":{"speech":"If two values should compare equal but they don\u2019t, it might be because they\u2019re different types. For example, 3 is an int but \u201c3\u201d is a string, so Python considers them to be totally different things and won\u2019t consider them equal.","buttons":[{"text":"Ah, that\'s it!","link":"Goodbye"},{"text":"I still need help","link":"Duck gives up"}]},"Complex condition":{"speech":"When using complex conditions, Python groups and before or. For instance, \u201ca or b and c\u201c is interpreted as \u201ca or (b and c)\u201d. If this isn\u2019t what you want, then insert parentheses (round brackets).","buttons":[{"text":"Ah, that\'s it!","link":"Goodbye"},{"text":"I still need help","link":"Simple condition"}]},"Certain parts skipped":{"speech":"Which of the following match your issue?","buttons":[{"text":"My list should be modified by every iteration of the loop but it\u2019s only modified by the last iteration","link":"List outside loop"},{"text":"The last iteration of my loop is getting skipped","link":"Last iter skipped"},{"text":"Something else","link":"Narrow down decision"}]},"List outside loop":{"speech":"This error happens if you have defined the list inside the loop. Move the definition of the list to before the loop begins, and that should fix your problem!","buttons":[{"text":"Ah, that\'s it!","link":"Goodbye"},{"text":"I still need help","link":"Duck gives up"}]},"Last iter skipped":{"speech":"The range function in Python stops before the end value. For instance, range(1,10) will iterate through values 1-9 but miss out 10. Increase the end parameter in your call to range, and see if that fixes the problem.","buttons":[{"text":"Ah, that\'s it!","link":"Goodbye"},{"text":"I still need help","link":"Duck gives up"}]},"Narrow down decision":{"speech":"Try narrowing down exactly where your program \u201cmakes the decision\u201d that skips a certain part of the code, by inserting display.show() calls (with different parameters!) after every line.","buttons":[{"text":"Ah, that\'s it!","link":"Goodbye"},{"text":"I still need help","link":"Duck gives up"}]},"List has changed":{"speech":"If you define a list in Python and then set a second list equal to the first, then any changes to the first list will happen in the second! Fix this by using the copy function on the first list. For example, instead of typing \u201clist2 = list1\u201d, type \u201clist2 = list1.copy()\u201d    ","buttons":[{"text":"Ah, that\'s it!","link":"Goodbye"},{"text":"I still need help","link":"Duck gives up"}]},"Division has given the wrong answer":{"speech":"If you divide two ints (whole numbers) in Python, it rounds the answer down to a whole number, instead of giving it as a decimal or fraction. If you want a decimal answer, write \u201c.0\u201d at the end of your numbers. Eg: type 3.0/4.0 instead of 3/4.","buttons":[{"text":"Ah, that\'s it!","link":"Goodbye"},{"text":"I still need help","link":"Duck gives up"}]},"Less common errors":{"speech":"Do any of these match your error?","buttons":[{"text":"IndexError","link":"IndexError explanation"},{"text":"ImportError","link":"ImportError explanation"},{"text":"KeyError","link":"KeyError explanation"},{"text":"ValueError","link":"ValueError explanation"},{"text":"ZeroDivisionError","link":"ZeroDivisionError explanation"},{"text":"None of them / I don\'t know","link":"{inTutorial ? Ask if want to compare : Duck gives up}"}]},"IndexError explanation":{"speech":"The word \\"index\\" means \\"position in a list\\", so an IndexError means that you are trying to access a position in a list that\'s after the end of the list! For example, if you try to get the 3rd item from a list with only 2 items, Python won\'t understand that. Remember that lists start at 0, so a list of length 3 will only have indexes 0,1, and 2.","buttons":[{"text":"Ah, that\'s it!","link":"Goodbye"},{"text":"I still need help","link":"{inTutorial ? Ask if want to compare : Duck gives up}"}]},"ImportError explanation":{"speech":"An ImportError normally means that you have misspelled a module that you\'re trying to import. For instance, check that you have spelt \'microbit\' correctly (and with a lower-case m!) in your \'import\' statment.","buttons":[{"text":"Ah, that\'s it!","link":"Goodbye"},{"text":"I still need help","link":"{inTutorial ? Ask if want to compare : Duck gives up}"}]},"KeyError explanation":{"speech":"A KeyError means that you are trying to access a value in a dictionary from a key that doesn\'t yet exist! This might be because you have misspelt the key, or because you forgot to add something to the dictionary before accessing it.","buttons":[{"text":"Ah, that\'s it!","link":"Goodbye"},{"text":"I still need help","link":"{inTutorial ? Ask if want to compare : Duck gives up}"}]},"ValueError explanation":{"speech":"A ValueError happens if you call a function with the wrong argument (parameter). Read the error message that comes with the error, to see why your argument doesn\'t work here.","buttons":[{"text":"Ah, that\'s it!","link":"Goodbye"},{"text":"I still need help","link":"{inTutorial ? Ask if want to compare : Duck gives up}"}]},"ZeroDivisionError explanation":{"speech":"The rules of maths don\'t allow you to divide by zero, but a ZeroDivisionError means that you are accidentally trying to divide something by zero!","buttons":[{"text":"Ah, that\'s it!","link":"Goodbye"},{"text":"I still need help","link":"{inTutorial ? Ask if want to compare : Duck gives up}"}]}}')},247:function(t,e,n){},321:function(t,e,n){},567:function(t,e,n){},568:function(t,e,n){"use strict";n.r(e);var r,i=n(5),a=n.n(i),o=n(22),s=n.n(o),u=n(6),c=n.n(u),l=n(18),h=n(0),d=n(1),p=n(14),f=n(3),b=n(4),x=n(602),g=n(114),y=n(167),m=n(2),v=n(154),k={connectOption:{baudRate:115200,dataBits:8,stopBits:1,parity:"none",bufferSize:4096,flowControl:"none"},requestOption:{filters:[{usbVendorId:3368}]},readOption:{showLog:!1,updateMs:50,cutLength:1e3},signalOption:{showLog:!0,validateAnswer:"microbit",replLineReady:">>> ",executionDone:"Execute Done: 0x3f3f3f3f",executionStart:"Execution Start: 0x3f3f3f3f",mainPYException:'Traceback (most recent call last):\r\n  File "main.py", line ',execException:'Traceback (most recent call last):\r\n  File "<stdin>", line 1, in <module>\r\n  File "<string>", line ',waitMsBeforeReboot:1}},w=n(88),j=n.n(w);!function(t){t[t.Free=0]="Free",t[t.Busy=1]="Busy"}(r||(r={}));var O=function(){function t(e,n){Object(h.a)(this,t),this.portReader=void 0,this.config=void 0,this.startSignals=void 0,this.endSignals=void 0,this.portReader=e,this.config=n,this.startSignals=[n.executionStart+"\r\n",n.mainPYException,n.execException],this.endSignals=[n.executionDone+"\r\n",n.executionStart+"\r\n",n.mainPYException,n.execException]}return Object(d.a)(t,[{key:"readUntilNewReplLine",value:function(){return this.portReader.safeReadUntil(this.config.replLineReady)}},{key:"readUntilMicroPython",value:function(){var t=Object(l.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.portReader.safeReadUntil(this.config.validateAnswer);case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"readUntilExecStart",value:function(){var t=Object(l.a)(c.a.mark((function t(e){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.config.showLog&&console.log("Waiting for Execution Start"),t.next=3,this.portReader.safeReadUntilWithUpdate(this.startSignals,(function(t){return null}));case 3:if(0===t.sent){t.next=9;break}return this.readErrors(e),t.abrupt("return",!1);case 9:return t.abrupt("return",!0);case 10:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"readUntilExecDone",value:function(){var t=Object(l.a)(c.a.mark((function t(e){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.config.showLog&&console.log("Execution Start"),n=1;case 2:if(1!==n){t.next=9;break}return t.next=5,this.portReader.safeReadUntilWithUpdate(this.endSignals,(function(t){return e.write({kind:"NormalOutput",outputChunk:t})}));case 5:1===(n=t.sent)&&e.write({kind:"ResetPressed"}),t.next=2;break;case 9:if(0===n){t.next=12;break}return t.next=12,this.readErrors(e);case 12:this.config.showLog&&console.log("Execution done");case 13:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"readErrors",value:function(){var t=Object(l.a)(c.a.mark((function t(e){var n,r,i,a,o;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.config.showLog&&console.log("Execution Error"),t.next=3,this.portReader.unsafeReadline();case 3:n=t.sent,r=n.split(",",2)[0],i=0,a="";case 7:if(0!==i&&!a.startsWith("  ")){t.next=14;break}return t.next=10,this.portReader.unsafeReadline();case 10:a=t.sent,i+=1,t.next=7;break;case 14:o=a.split(": "),e.write({kind:"ErrorMessage",line:parseInt(r)-1,type:o[0],message:1===o.length?"":o[1]});case 16:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),t}(),E=function(){function t(e,n){Object(h.a)(this,t),this.serialBuffer="",this.portReader=void 0,this.config=void 0,this.portReader=e,this.config=n}return Object(d.a)(t,[{key:"readLoop",value:function(){var t=Object(l.a)(c.a.mark((function t(e){var n,r;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.config.showLog&&console.log(this.serialBuffer);case 1:if(e(this.serialBuffer)){t.next=13;break}return t.next=4,this.portReader.read();case 4:if(n=t.sent,r=n.value,!n.done){t.next=9;break}return t.abrupt("break",13);case 9:this.serialBuffer+=r,this.config.showLog&&console.log(this.serialBuffer),t.next=1;break;case 13:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"readLoopWithCut",value:function(){var t=Object(l.a)(c.a.mark((function t(e,n){var r,i,a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.config.showLog&&console.log(this.serialBuffer);case 1:if(e(this.serialBuffer)){t.next=15;break}return(r=this.serialBuffer.length)>=n&&(this.serialBuffer=this.serialBuffer.substring(r-n)),t.next=6,this.portReader.read();case 6:if(i=t.sent,a=i.value,!i.done){t.next=11;break}return t.abrupt("break",15);case 11:this.serialBuffer+=a,this.config.showLog&&console.log(this.serialBuffer),t.next=1;break;case 15:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"splitBufferOnFirst",value:function(t){var e=this.serialBuffer.indexOf(t),n=this.serialBuffer.substr(0,e);return this.serialBuffer=this.serialBuffer.substr(e+t.length),n}},{key:"unsafeReadline",value:function(){var t=Object(l.a)(c.a.mark((function t(){var e;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e="\r\n",t.next=3,this.readLoop((function(t){return t.includes(e)}));case 3:return t.abrupt("return",this.splitBufferOnFirst(e));case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"safeReadUntil",value:function(){var t=Object(l.a)(c.a.mark((function t(e){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.readLoopWithCut((function(t){return t.includes(e)}),e.length);case 2:this.splitBufferOnFirst(e);case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"safeReadUntilWithUpdate",value:function(){var t=Object(l.a)(c.a.mark((function t(e,n){var r,i,a,o,s=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=!1,i=-1,a=function(t){return r=!0,e.forEach((function(e,n){t.includes(e)&&(i=n)})),-1!==i},o=setInterval((function(){r&&(n(s.serialBuffer),r=!1)}),this.config.updateMs),t.next=6,this.readLoopWithCut(a,this.config.cutLength);case 6:return clearInterval(o),n(this.splitBufferOnFirst(e[i])),t.abrupt("return",i);case 9:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()}]),t}(),I=function(){function t(e,n){if(Object(h.a)(this,t),this.port=void 0,this.portWriter=void 0,this.portReader=void 0,this.portParser=void 0,this.signal=void 0,this.state=void 0,this.portWriterStreamClosed=null,this.portReaderStreamClosed=null,this.port=e,this.signal=n.signalOption,this.state=r.Free,null!=e.writable){var i=new TextEncoderStream;this.portWriterStreamClosed=i.readable.pipeTo(e.writable).catch((function(t){console.log("disconnected in pipe")})),this.portWriter=i.writable.getWriter()}if(null!=e.readable){var a=new TextDecoderStream;this.portReaderStreamClosed=e.readable.pipeTo(a.writable).catch((function(t){console.log("disconnected in pipe")})),this.portReader=a.readable.getReader();var o=new E(this.portReader,n.readOption);this.portParser=new O(o,n.signalOption)}}return Object(d.a)(t,[{key:"getState",value:function(){return this.state}},{key:"codeToPythonString",value:function(t){return("print('"+this.signal.executionStart+"')\r\n"+t+"\r\nprint('"+this.signal.executionDone+"')").replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/\r?\n/g,"\\r\\n")}},{key:"getREPLLine",value:function(){var t=Object(l.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.portWriter.write("\x03");case 2:return t.next=4,this.portParser.readUntilNewReplLine();case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"validateMicroPython",value:function(t){var e=this;return new Promise(function(){var n=Object(l.a)(c.a.mark((function n(r,i){return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return setTimeout((function(){r(!1)}),t),n.next=3,e.getREPLLine();case 3:return n.next=5,e.portWriter.write("import sys;sys.platform\r");case 5:return n.next=7,e.portParser.readUntilMicroPython();case 7:r(!0);case 8:case"end":return n.stop()}}),n)})));return function(t,e){return n.apply(this,arguments)}}())}},{key:"flash",value:function(){var t=Object(l.a)(c.a.mark((function t(e){var n,i,a=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.state!==r.Busy){t.next=2;break}throw Error("Flash Failed: Device not free");case 2:return this.state=r.Busy,n=this.codeToPythonString(e),i=new j.a,t.next=7,this.getREPLLine();case 7:return t.next=9,this.portWriter.write("file=open('main.py','w');s='"+n+"';file.write(s);file.close();from microbit import *;reset()\r");case 9:return t.next=11,this.portParser.readUntilExecStart(i);case 11:if(!t.sent){t.next=15;break}this.portParser.readUntilExecDone(i).then((function(){a.state=r.Free})).finally((function(){i.end()})),t.next=16;break;case 15:this.state=r.Free;case 16:return t.abrupt("return",i);case 17:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"execute",value:function(){var t=Object(l.a)(c.a.mark((function t(e){var n,i,a=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.state!==r.Busy){t.next=2;break}throw Error("Execute Failed: Device not free");case 2:return this.state=r.Busy,n=this.codeToPythonString(e),i=new j.a,t.next=7,this.getREPLLine();case 7:return t.next=9,this.portWriter.write("s='"+n+"';exec(s)\r");case 9:return t.next=11,this.portParser.readUntilExecStart(i);case 11:if(!t.sent){t.next=15;break}this.portParser.readUntilExecDone(i).then((function(){a.state=r.Free})).finally((function(){i.end()})),t.next=16;break;case 15:this.state=r.Free;case 16:return t.abrupt("return",i);case 17:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"getCompletions",value:function(){var t=Object(l.a)(c.a.mark((function t(e){var n,i,a,o,s,u,l,h,d,p,f;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.state!==r.Busy){t.next=2;break}throw Error("Autocomplete Failed: Device not free");case 2:return this.state=r.Busy,n="END MARKER",i="",t.next=7,this.getREPLLine();case 7:return t.next=9,this.portWriter.write("".concat(e,"\t"));case 9:return t.next=11,this.portWriter.write(n);case 11:return t.next=13,this.portParser.portReader.safeReadUntilWithUpdate([n],(function(t){return i=t}));case 13:return t.next=15,this.getREPLLine();case 15:if(this.state=r.Free,1!==(a=i.split(/\n/g)).length){t.next=24;break}if((o=a[0])!==e){t.next=23;break}return t.abrupt("return",[]);case 23:return t.abrupt("return",[o]);case 24:s=[],u=Object(m.a)(a.slice(1,-1));try{for(u.s();!(l=u.n()).done;){h=l.value,d=Object(m.a)(h.trim().split(/\s+/g));try{for(d.s();!(p=d.n()).done;)(f=p.value).length>0&&s.push(f.trim())}catch(c){d.e(c)}finally{d.f()}}}catch(c){u.e(c)}finally{u.f()}return t.abrupt("return",s);case 28:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"reboot",value:function(){var t=Object(l.a)(c.a.mark((function t(){var e,n=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.state!==r.Busy){t.next=2;break}throw Error("Reboot Failed: Device not free");case 2:return this.state=r.Busy,t.next=5,this.getREPLLine();case 5:return t.next=7,this.portWriter.write("from microbit import *;reset()\r");case 7:return e=new j.a,t.next=10,this.portParser.readUntilExecStart(e);case 10:if(!t.sent){t.next=14;break}this.portParser.readUntilExecDone(e).then((function(){n.state=r.Free})).finally((function(){e.end()})),t.next=15;break;case 14:this.state=r.Free;case 15:return t.abrupt("return",e);case 16:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"waitUntil",value:function(t){return new Promise((function(e,n){var r=setInterval((function(){t()&&(clearInterval(r),e())}),200)}))}},{key:"interrupt",value:function(){var t=Object(l.a)(c.a.mark((function t(){var e=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.state!==r.Free){t.next=2;break}throw Error("Interrupt Failed: Device not running code");case 2:return t.next=4,this.portWriter.write("\x03");case 4:return t.next=6,this.waitUntil((function(){return e.state===r.Free}));case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"disconnect",value:function(){var t=Object(l.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Disconnection initiated:"),t.next=3,this.portReader.cancel("App will unmount");case 3:return t.next=5,this.portReaderStreamClosed;case 5:return console.log("Reader closed;"),t.next=8,this.portWriter.abort("App will unmount");case 8:return t.next=10,this.portWriterStreamClosed;case 10:return console.log("Writer closed."),t.next=13,this.port.close();case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),t}();function S(t,e){return D.apply(this,arguments)}function D(){return(D=Object(l.a)(c.a.mark((function t(e,n){var r;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.open(n.connectOption);case 3:t.next=8;break;case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return",{kind:"ConnectionFailure",type:"Failed to Open Port",reason:t.t0.message});case 8:return r=new I(e,n),t.next=11,r.validateMicroPython(3e3);case 11:if(t.sent){t.next=15;break}return t.next=14,r.disconnect();case 14:return t.abrupt("return",{kind:"ConnectionFailure",type:"No Response on Validation",reason:"Possibly not a microbit with MicroPython"});case 15:return t.abrupt("return",{kind:"MicrobitConnection",interact:r,disconnection:new Promise((function(t,n){e.addEventListener("disconnect",(function n(r){console.log("disconnected"),e.removeEventListener("disconnect",n),t()}))}))});case 16:case"end":return t.stop()}}),t,null,[[0,5]])})))).apply(this,arguments)}function C(){return R.apply(this,arguments)}function R(){return(R=Object(l.a)(c.a.mark((function t(){var e,n,r=arguments;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=r.length>0&&void 0!==r[0]?r[0]:k,t.prev=1,t.next=4,navigator.serial.requestPort(e.requestOption);case 4:n=t.sent,t.next=10;break;case 7:return t.prev=7,t.t0=t.catch(1),t.abrupt("return",{kind:"ConnectionFailure",type:"Failed to Obtain Port",reason:t.t0.message});case 10:return t.abrupt("return",S(n,e));case 11:case"end":return t.stop()}}),t,null,[[1,7]])})))).apply(this,arguments)}function T(){return P.apply(this,arguments)}function P(){return(P=Object(l.a)(c.a.mark((function t(){var e,n,r=arguments;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=r.length>0&&void 0!==r[0]?r[0]:k,t.next=3,navigator.serial.getPorts();case 3:if(1!==(n=t.sent).length){t.next=8;break}return t.abrupt("return",S(n[0],e));case 8:if(0!==n.length){t.next=12;break}return t.abrupt("return",{kind:"ConnectionFailure",type:"Failed to Obtain Port",reason:"No Paired Serial Devices Available"});case 12:return t.abrupt("return",{kind:"ConnectionFailure",type:"Failed to Obtain Port",reason:"Multiple Paired Serial Devices Available"});case 13:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function A(){return L.apply(this,arguments)}function L(){return(L=Object(l.a)(c.a.mark((function t(){var e,n,r=arguments;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=function(t,e){if(void 0===e)return!0;var n,r=Object(m.a)(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;if((void 0===i.usbProductId||i.usbProductId===t.usbProductId)&&(void 0===i.usbVendorId||i.usbVendorId===t.usbVendorId))return!0}}catch(a){r.e(a)}finally{r.f()}return!1},e=r.length>0&&void 0!==r[0]?r[0]:k,t.abrupt("return",new Promise((function(t,r){var i=function(){var r=Object(l.a)(c.a.mark((function r(a){var o;return c.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:o=a.port||a.target,n(o.getInfo(),e.requestOption.filters)&&(navigator.serial.removeEventListener("connect",i),t(S(o,e)));case 2:case"end":return r.stop()}}),r)})));return function(t){return r.apply(this,arguments)}}();navigator.serial.addEventListener("connect",i)})));case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var F=n(11),N=n(89),B=n(600),M=n(168),W=n(598),U=n(601),G=n(155),_=n(33),V=n.p+"static/media/Duck.d495e477.jpg",z=(n(243),n(15)),H=Object(M.a)({palette:{primary:{main:"#ffcc00"}}}),q=Object(W.a)((function(t){return{button:{flexGrow:1,border:1,borderRadius:3,color:"black",height:48,padding:t.spacing(2),margin:8,textAlign:"center",textTransform:"none"},xButton:{color:"white",backgroundColor:"#ff0000",height:20,padding:t.spacing(2),textAlign:"center"},speech:{flexGrow:1,border:1,borderRadius:3,color:"black",padding:t.spacing(2),margin:8,textAlign:"left"}}})),K=n(245),Y=Object.keys(K);function Z(t,e){return"get_readable_diff"===t?function(t){if(t.lineNumber&&t.lineText&&t.tutorialCode){var e=t.lineText.trim(),n=t.tutorialCode.split("\n").map((function(t){return t.trim()})),r=new G.a(n,{includeMatches:!0,isCaseSensitive:!0}).search(e);if(r.length>0){var i=r[0],a=function(t,e){var n=!1,r=t.length,i=e.length,a=[],o=0,s=[],u=0;for(;o<r&&u<i;)if(t[o]===e[u])o++,u++;else if(o+1===r||u+1===i)a.push(o),o++,s.push(u),++u+1!==i&&(n=!0);else{var c=h(t.slice(o,o+2),e,u,10),l=h(e.slice(u,u+2),t,o,10);if(l){for(;o<l;)a.push(o),o++;o+=2,u+=2}else if(c){for(;u<c;)s.push(u),u++;o+=2,u+=2}else a.push(o),o++,s.push(u),u++}for(;o<r;)a.push(o),o++;for(;u<i;)s.push(u),u++;n&&t[o-1]===e[u-1]&&(a.pop(),s.pop());function h(t,e,n,r){for(var i=n;i!==n+r&&i+1<e.length;i++)if(e[i]===t[0]&&e[i+1]===t[1])return i}return[a,s]}(e,i.item);return Object(z.jsxs)("div",{children:["The closest matching line in the tutorial is: ",Object(z.jsx)("br",{}),J(i.item,a[1])," ",Object(z.jsx)("br",{}),"whereas your line reads: ",Object(z.jsx)("br",{}),J(e,a[0])]})}return"Unfortunately, your line does not look like any of the lines in the tutorial."}return t.isErrorTute?"I see that you are following the tutorial on errors. I cannot simply tell you the correct answer - why don't you reread the tutorial and see if that helps?":"I cannot see your error message. Perhaps press 'RUN' again, and double check that an error message is visible?"}(e):"get_error_line_no_and_highlight"===t?function(t){return t.lineNumber?Object(z.jsxs)("div",{children:["Your error is on line"," "+t.lineNumber,", so I\u2019ve highlighted that line in the editor. What type of error is displayed?"]}):"I cannot see your error message. Perhaps press 'RUN' again, and double check that an error message is visible?"}(e):t}function J(t,e){for(var n=[],r=0;r<t.length;r++)r===e[0]?(e.shift(),n.push(Object(z.jsx)("span",{style:{backgroundColor:"yellow"},children:Object(z.jsx)(N.a,{display:"inline",children:t[r]})}))):n.push(Object(z.jsx)("span",{children:Object(z.jsx)(N.a,{display:"inline",children:t[r]})}));return n}function Q(t,e){return t.split(/(\{[\S\s]+?\})/g).filter(Boolean).map((function(t){return function(t,e){var n=t;return t.startsWith("{")&&(n=Z(t.slice(1,-1),e)),n}(t,e)}))}function X(t){return function(t,e){var n=q(),r=Object(i.useState)(t),a=Object(F.a)(r,2),o=a[0],s=a[1];return Object(z.jsxs)(_.c,{height:600,width:600,children:[Object(z.jsx)("div",{children:Object(z.jsx)("img",{src:V,height:600,width:600,alt:"cartoon duck"})}),Object(z.jsx)(_.d,{size:60}),Object(z.jsxs)(_.b,{children:[Object(z.jsx)(_.f,{size:20}),Object(z.jsx)(_.b,{children:Object(z.jsxs)(_.b,{children:[Object(z.jsx)(N.a,{className:n.speech,children:Q(K[o].speech,e)}),Object(z.jsx)(B.a,{container:!0,justify:"center",alignItems:"flex-start",spacing:2,children:K[o].buttons.map((function(t){return Object(z.jsx)("div",{children:Object(z.jsx)(B.a,{item:!0,xs:!0,children:Object(z.jsx)(U.a,{theme:H,children:Object(z.jsx)(x.a,{className:n.button,variant:"contained",color:"primary",onClick:function(){if("{inTutorial ? Ask if want to compare : Duck gives up}"===t.link){var n=function(t){return void 0!==t.tutorialCode&&""!==t.tutorialCode}(e)?"Ask if want to compare":"Duck gives up";s(n)}else t.link?s(t.link):e.closeDuck()},children:t.text})})})},t.text)}))})]})}),Object(z.jsx)(_.a,{size:200})]}),Object(z.jsx)(_.e,{size:250,children:Object(z.jsx)(_.e,{size:430,children:Object(z.jsx)(_.a,{size:600,children:Object(z.jsx)(x.a,{className:n.xButton,variant:"contained",size:"small",onClick:function(){e.closeDuck()},children:"X"})})})})]})}(Y[0],t)}n(247);var $=n(612),tt=n(604),et=n(605),nt=n(614),rt=n(606),it=n(603);function at(t){var e=Object(i.useState)(!1),n=Object(F.a)(e,2),r=n[0],a=n[1];return Object(z.jsxs)(z.Fragment,{children:[Object(z.jsxs)(x.a,{onClick:function(){return a(!0)},children:[Object(z.jsx)(it.a,{}),"Select Tutorial"]}),Object(z.jsx)($.a,{open:r,onClose:function(){return a(!1)},children:Object(z.jsx)(tt.a,{subheader:Object(z.jsx)(et.a,{component:"div",id:"nested-list-subheader",children:Object(z.jsx)("h2",{children:"Available tutorials"})}),children:t.tutorialList.list.map((function(e){var n=e.title;return Object(z.jsx)(nt.a,{button:!0,onClick:function(){return t.onTutorialSelection(e)},children:Object(z.jsx)(rt.a,{primary:n})},n)}))})})]})}var ot=n(12),st=n(162),ut=n.n(st),ct=(n(321),n(613)),lt=n(607),ht=n(608),dt=n(609),pt=n(610),ft=n(611),bt=function(t){Object(f.a)(n,t);var e=Object(b.a)(n);function n(t){var r;if(Object(h.a)(this,n),(r=e.call(this,t)).isExpandable=void 0,r.highlightStart=void 0,r.highlightEnd=void 0,r.lines=void 0,r.highlightedLines=void 0,r.isExpandable=!1,r.lines=r.props.code.split("\n"),r.highlightStart=0,r.highlightEnd=r.lines.length,r.lines.length>0){var i=r.lines[0].split("# LINES ");if(2===i.length){var a=function(t,e,n){return isNaN(t)?(alert("Failed to parse ".concat(e,": ").concat(t)),!1):t<1?(alert("".concat(e," must be at least 1: ").concat(t)),!1):!(t>n)||(alert("".concat(e," must not exceed the biggest line number ").concat(n)),!1)},o=i[1].split("-"),s=parseInt(o[0]),u=parseInt(o[1]);a(s,"Starting line",r.lines.length)&&a(u,"Ending line",r.lines.length)&&(s<=u?(r.highlightStart=s-1,r.highlightEnd=u-1+1,r.isExpandable=!0):alert("The starting line number must be at least the ending line number, but got ".concat(s," < ").concat(u)))}}return r.highlightedLines=r.lines.slice(r.highlightStart,r.highlightEnd),r.state={isExpanded:!r.isExpandable,output:""},r}return Object(d.a)(n,[{key:"onToggleExpand",value:function(){this.setState({isExpanded:!this.state.isExpanded})}},{key:"onRun",value:function(){var t=Object(l.a)(c.a.mark((function t(){var e,n,r=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.setState({output:""}),this.props.canRun()){t.next=5;break}return alert("UI lied: Device is NOT free"),this.props.onRunFinished(),t.abrupt("return");case 5:return t.next=7,this.props.onRun(this.props.code);case 7:return e=t.sent,n="",t.next=11,e.forEach((function(t){switch(t.kind){case"NormalOutput":n=t.outputChunk;break;case"ErrorMessage":if("KeyboardInterrupt"===t.type)break;n="".concat(n,"Error on line ").concat(t.line,":\n").concat(t.type,": ").concat(t.message)}r.setState({output:n})}));case 11:this.props.onRunFinished();case 12:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"onInsertIntoEditor",value:function(){this.props.onInsertIntoEditor(this.highlightedLines.join("\n"))}},{key:"getDisplayedText",value:function(){var t;return this.state.isExpanded?t=this.lines:(t=this.highlightedLines,this.highlightStart>0&&(t=["# ..."].concat(Object(ot.a)(t))),this.highlightEnd<this.lines.length&&(t=[].concat(Object(ot.a)(t),["# ..."]))),t.join("\n")}},{key:"render",value:function(){return Object(z.jsxs)("div",{children:[Object(z.jsx)(ct.a,{style:lt.a,language:"py",showLineNumbers:this.state.isExpanded,children:this.getDisplayedText()}),Object(z.jsxs)("div",{className:"Tutorial-code-buttonbar",children:[Object(z.jsx)(x.a,{className:"Tutorial-code-buttons",variant:"contained",color:"primary",startIcon:Object(z.jsx)(ht.a,{}),disabled:!this.props.canRun(),onClick:this.onRun.bind(this),children:"Run Example"}),this.isExpandable&&Object(z.jsx)(x.a,{className:"Tutorial-code-buttons",variant:"contained",endIcon:this.state.isExpanded?Object(z.jsx)(dt.a,{}):Object(z.jsx)(pt.a,{}),onClick:this.onToggleExpand.bind(this),children:"Full Code:"}),Object(z.jsx)(x.a,{className:"Tutorial-code-buttons",variant:"contained",color:"secondary",endIcon:Object(z.jsx)(ft.a,{}),disabled:!this.props.canInsertIntoEditor(),onClick:this.onInsertIntoEditor.bind(this),children:"Insert Fragment"})]}),this.state.output.length>0&&Object(z.jsx)("div",{className:"Tutorial-output",children:this.state.output})]})}}]),n}(a.a.Component),xt=function(t){Object(f.a)(n,t);var e=Object(b.a)(n);function n(){var t;Object(h.a)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))).renderers={code:t.renderCode.bind(Object(p.a)(t))},t}return Object(d.a)(n,[{key:"renderCode",value:function(t){return"py"===t.language?Object(z.jsx)(bt,{code:t.value,onRun:this.props.onRun,onRunFinished:this.props.onRunFinished,onInsertIntoEditor:this.props.onInsertIntoEditor,canRun:this.props.canRun,canInsertIntoEditor:this.props.canInsertInsertIntoEditor}):Object(z.jsx)(ct.a,{style:lt.a,language:t.language,children:t.value})}},{key:"render",value:function(){return Object(z.jsx)(ut.a,{className:"Tutorial-markdown",renderers:this.renderers,children:this.props.markdown})}}]),n}(a.a.Component),gt=function(t){Object(f.a)(n,t);var e=Object(b.a)(n);function n(t){var r;return Object(h.a)(this,n),(r=e.call(this,t)).state={tutorial:null,output:"",connection:null,editor:null,monaco:null,needDuck:!1,errorString:"",errorLine:0,errorMonacoIDs:null},"serial"in navigator||"usb"in navigator&&(navigator.serial=v.serial,1)||alert("Browser not supported"),g.b.init().then((function(t){console.log(t)})),r.beforeExecution=r.beforeExecution.bind(Object(p.a)(r)),r}return Object(d.a)(n,[{key:"handleTutorialPathChange",value:function(){var t=Object(l.a)(c.a.mark((function t(e){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.props.tutorialResolver.resolve(e);case 2:null!==(n=t.sent)?this.setState({tutorial:n}):alert("Failed to access tutorial. Please try again later.");case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var t=Object(l.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.handleTutorialPathChange(this.props.tutorialList.default);case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"handleEditorDidMount",value:function(t,e){var n=this;this.setState({editor:t,monaco:e});var r=function(){var t=Object(l.a)(c.a.mark((function t(e){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.hasFreeConnection()){t.next=4;break}return t.abrupt("return",n.state.connection.interact.getCompletions(e));case 4:return t.abrupt("return",[]);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();e.languages.registerCompletionItemProvider("python",{triggerCharacters:["_",".","(","["],provideCompletionItems:function(t,n,i,a){return Object(l.a)(c.a.mark((function i(){var a,o,s,u,l,h,d;return c.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:for(a=t.getLineContent(n.lineNumber),o=n.column-1;o>=0&&" "!==a[o];)o-=1;return s=o+1,u=a.slice(s,n.column-1),i.next=7,r(u);case 7:if(1!==(l=i.sent).length){i.next=14;break}if(h=l[0],d={startColumn:s+1,endColumn:n.column,startLineNumber:n.lineNumber,endLineNumber:n.lineNumber},h.endsWith("_")){i.next=13;break}return i.abrupt("return",{suggestions:[{kind:e.languages.CompletionItemKind.Constant,label:h,insertText:h,range:d}]});case 13:return i.abrupt("return",{suggestions:[{kind:e.languages.CompletionItemKind.Constant,label:h,range:d,insertText:h.slice(0,-1)}]});case 14:return i.abrupt("return",{suggestions:l.map((function(t){return{kind:e.languages.CompletionItemKind.Constant,label:t,insertText:t}}))});case 15:case"end":return i.stop()}}),i)})))()}})}},{key:"componentWillUnmount",value:function(){var t;null===(t=this.state.connection)||void 0===t||t.interact.disconnect()}},{key:"renderHeaderButton",value:function(t,e,n){var r=this;return Object(z.jsx)(x.a,{className:"APIDemo-button",variant:"contained",size:"large",disabled:!n(),onClick:function(){n()?e():(alert("UI lied: button ".concat(t," should NOT be enabled")),r.setState({}))},children:t})}},{key:"hasFreeConnection",value:function(){var t;return(null===(t=this.state.connection)||void 0===t?void 0:t.interact.getState())===r.Free}},{key:"hasBusyConnection",value:function(){var t;return(null===(t=this.state.connection)||void 0===t?void 0:t.interact.getState())===r.Busy}},{key:"isEditorMounted",value:function(){return null!=this.state.editor}},{key:"getTuteCode",value:function(t){for(var e=t.split("\n"),n=[],r=0;r<e.length;){if("```py"===e[r].slice(0,5))for(r++;"```"!==e[r].slice(0,3);)n.push(e[r]),r++;else if("~~~py"===e[r].slice(0,5))for(r++;"~~~"!==e[r].slice(0,3);)n.push(e[r]),r++;r++}return n.join("\n")}},{key:"renderDuck",value:function(){var t,e,n,r,i=this.getTuteCode(null!==(t=null===(e=this.state.tutorial)||void 0===e?void 0:e.raw_content)&&void 0!==t?t:"");return(null===(n=this.state.tutorial)||void 0===n?void 0:n.disable_duck)?Object(z.jsx)(X,{closeDuck:this.exileDuck.bind(this),tutorialCode:i,isErrorTute:!0}):""===this.state.errorString||(null===(r=this.state.tutorial)||void 0===r?void 0:r.disable_duck)?Object(z.jsx)(X,{closeDuck:this.exileDuck.bind(this),tutorialCode:i}):Object(z.jsx)(X,{closeDuck:this.exileDuck.bind(this),lineNumber:this.state.errorLine,lineText:this.state.editor.getValue().split("\n")[this.state.errorLine-1],tutorialCode:i})}},{key:"renderTutorial",value:function(){var t,e,n=this;return Object(z.jsx)("div",{className:"APIDemo-tutorial",children:this.state.needDuck?Object(z.jsxs)("div",{children:[Object(z.jsx)("h1",{children:this.state.errorString}),this.renderDuck()]}):Object(z.jsx)(xt,{markdown:null!==(t=null===(e=this.state.tutorial)||void 0===e?void 0:e.raw_content)&&void 0!==t?t:"# Fetching tutorial...",onRun:this.onRunCell.bind(this),onRunFinished:function(){return n.setState({})},canRun:this.hasFreeConnection.bind(this),onInsertIntoEditor:this.onInsertIntoEditor.bind(this),canInsertInsertIntoEditor:this.isEditorMounted.bind(this)})})}},{key:"renderEditor",value:function(){return Object(z.jsx)(g.a,{defaultLanguage:"python",defaultValue:"# Add your Python code here. E.g.\nfrom microbit import *\n\nwhile True:\n    display.scroll('Hello, World!')\n    display.show(Image.HEART)\n    sleep(2000)\n",onMount:this.handleEditorDidMount.bind(this),theme:"light",options:{minimap:{enabled:!1},fontSize:18},wrapperClassName:"APIDemo-code"})}},{key:"renderOutput",value:function(){return Object(z.jsx)("textarea",{className:"APIDemo-output",value:this.state.output,readOnly:!0})}},{key:"render",value:function(){var t=this;return Object(z.jsxs)("div",{className:"APIDemo",children:[Object(z.jsxs)("div",{className:"APIDemo-header",children:[Object(z.jsxs)("header",{className:"APIDemo-header-buttons",children:[this.renderHeaderButton("Start",this.onStart.bind(this),(function(){return null==t.state.connection})),this.renderHeaderButton("Flash",(function(){return t.onFlash(t.state.editor.getValue())}),(function(){return t.isEditorMounted()&&t.hasFreeConnection()})),this.renderHeaderButton("Run",(function(){return t.onRun(t.state.editor.getValue())}),(function(){return t.isEditorMounted()&&t.hasFreeConnection()})),this.renderHeaderButton("Interrupt",this.onInterrupt.bind(this),(function(){return t.hasBusyConnection()})),this.renderHeaderButton("Reboot",this.onReboot.bind(this),(function(){return t.hasFreeConnection()})),this.renderHeaderButton("Help",this.summonDuck.bind(this),(function(){return!0}))]}),Object(z.jsx)(at,{tutorialList:this.props.tutorialList,onTutorialSelection:this.handleTutorialPathChange.bind(this)})]}),Object(z.jsxs)("div",{className:"APIDemo-body",children:[this.renderTutorial(),this.renderEditor(),this.renderOutput()]})]})}},{key:"connect",value:function(){var t=Object(l.a)(c.a.mark((function t(e){var n,r=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e;case 2:n=t.sent,t.t0=n.kind,t.next="ConnectionFailure"===t.t0?6:"MicrobitConnection"===t.t0?8:11;break;case 6:return alert(n.reason),t.abrupt("return",!1);case 8:return this.setState({connection:n}),n.disconnection.then(Object(l.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:alert("Serial disconnected"),r.setState({connection:null},Object(l.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.connect(A());case 2:alert("Serial reconnected");case 3:case"end":return t.stop()}}),t)}))));case 2:case"end":return t.stop()}}),t)})))),t.abrupt("return",!0);case 11:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"onInsertIntoEditor",value:function(t){var e,n=this.state.editor;if(null!=n){var r=n.getSelection();if(null!=r){var i=r.getPosition(),a={startLineNumber:i.lineNumber,endLineNumber:i.lineNumber,startColumn:i.column,endColumn:i.column};null===(e=n.getModel())||void 0===e||e.pushEditOperations([r],[{range:a,text:t}],(function(t){return null})),n.focus()}else alert("selection is null")}else alert("Editor is not loaded")}},{key:"summonDuck",value:function(){this.setState({needDuck:!0})}},{key:"exileDuck",value:function(){this.setState({needDuck:!1})}},{key:"onStart",value:function(){var t=Object(l.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.connect(T());case 2:if(t.sent){t.next=5;break}return t.next=5,this.connect(C());case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"beforeExecution",value:function(){var t=this.state.editor,e=this.state.errorMonacoIDs;t.updateOptions({readOnly:!0}),null!=e&&(this.exileDuck(),t.deltaDecorations(e,[]),this.setState({errorMonacoIDs:null}))}},{key:"onExec",value:function(){var t=Object(l.a)(c.a.mark((function t(e){var n,r=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.setState({}),t.next=3,e.forEach((function(t){switch(t.kind){case"NormalOutput":r.setState({output:t.outputChunk,errorString:""});break;case"ResetPressed":console.log("ResetPressed");break;case"ErrorMessage":if("KeyboardInterrupt"!==t.type){console.log(t.message);var e=r.state.editor,n=e.deltaDecorations([],[{range:new y.a(t.line,1,t.line,1),options:{isWholeLine:!0,className:"Monaco-Error-Line-Of-Code"}}]);r.setState({errorString:"Error on line "+t.line+":\n"+t.type+": "+t.message,errorLine:t.line,errorMonacoIDs:n}),e.updateOptions({readOnly:!1}),r.summonDuck()}}}));case 3:this.setState({}),null===(n=this.state.editor)||void 0===n||n.updateOptions({readOnly:!1});case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"onFlash",value:function(){var t=Object(l.a)(c.a.mark((function t(e){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("onFlash"),this.beforeExecution(),t.t0=this,t.next=5,this.state.connection.interact.flash(e);case 5:return t.t1=t.sent,t.next=8,t.t0.onExec.call(t.t0,t.t1);case 8:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"onRun",value:function(){var t=Object(l.a)(c.a.mark((function t(e){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("onRun"),this.beforeExecution(),t.t0=this,t.next=5,this.state.connection.interact.execute(e);case 5:return t.t1=t.sent,t.next=8,t.t0.onExec.call(t.t0,t.t1);case 8:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"onRunCell",value:function(){var t=Object(l.a)(c.a.mark((function t(e){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("onRunCell"),t.next=3,this.state.connection.interact.execute(e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"onReboot",value:function(){var t=Object(l.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("onReboot"),this.beforeExecution(),t.t0=this,t.next=5,this.state.connection.interact.reboot();case 5:return t.t1=t.sent,t.next=8,t.t0.onExec.call(t.t0,t.t1);case 8:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"onInterrupt",value:function(){var t=Object(l.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.state.connection.interact.interrupt();case 2:this.setState({});case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),n}(a.a.Component),yt=(n(567),{path:"PythonTute.md",title:"Python Language Features"}),mt={default:yt,list:[yt,{path:"ErrorTute.md",title:"Python Errors"},{path:"DisplayTute.md",title:"Displaying Images on micro:bit"}]},vt={resolve:function(t){return Object(l.a)(c.a.mark((function e(){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("./tutorials/".concat(t.path));case 3:if(!(n=e.sent).ok){e.next=12;break}return e.next=7,n.text();case 7:e.t1=e.sent,e.t2="ErrorTute.md"===t.path,e.t0={raw_content:e.t1,disable_duck:e.t2},e.next=13;break;case 12:e.t0=null;case 13:return e.abrupt("return",e.t0);case 16:return e.prev=16,e.t3=e.catch(0),console.log(e.t3),e.abrupt("return",null);case 20:case"end":return e.stop()}}),e,null,[[0,16]])})))()}};s.a.render(Object(z.jsx)(a.a.StrictMode,{children:Object(z.jsx)(gt,{tutorialList:mt,tutorialResolver:vt})}),document.getElementById("root"))}},[[568,1,2]]]);
//# sourceMappingURL=main.21c45761.chunk.js.map